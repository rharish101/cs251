\documentclass[11pt]{article}
\usepackage[margin=2.5cm]{geometry}
\usepackage{anyfontsize}
\usepackage{environ}
\usepackage{xcolor, adjustbox}
\usepackage[fleqn]{amsmath}
\usepackage{amssymb}
\usepackage{enumitem}
\usepackage{mdframed}
\usepackage{ifthen}
\usepackage{array,multirow,booktabs,longtable}
\usepackage{fontspec}
    \setmainfont{Roboto Light}
    \newfontfamily\defaultfont{Roboto Light}
    \newfontfamily\monospace{Roboto Mono Light for Powerline}
    \newfontfamily\mathfont{CMU Serif}
    \linespread{1.1}
\usepackage{algpseudocode}
\usepackage[plain]{algorithm}
\usepackage{fullwidth}

\newcommand\tab[1][8mm]{\hspace*{#1}}
\NewEnviron{mycode}
{
    \definecolor{darkgray}{gray}{0.5}
    \definecolor{codegray}{gray}{0.9}
    \hspace{-0.5mm}
    \vspace{-1mm}
    \begin{adjustbox}{margin=2mm,bgcolor=codegray}
        \begin{minipage}{15.4cm}
            \fontsize{9}{12}\selectfont\monospace
            \begin{enumerate}[leftmargin=10mm,label={\color{darkgray}\arabic*\tab[4mm]}]
                \setlength{\itemsep}{-1.5mm}
                \BODY
            \end{enumerate}
        \end{minipage}
    \end{adjustbox}
    \vspace{+2mm}
}

\algrenewcommand\alglinenumber[1]{\small\upshape\monospace#1\tab[2mm]}
\renewcommand{\algorithmiccomment}[1]{\hfill// #1}
\NewEnviron{mypseudocode}[2]
{
    \textsc{#1} (\textit{#2})\par
    \vspace{-7mm}
    \begin{flushright}\rule{15.77cm}{0.7pt}\end{flushright}
    \vspace{-9mm}
    \begin{fullwidth}[width=\linewidth-12mm,leftmargin=1cm,rightmargin=1cm]
        \begin{algorithm}[H]
            \begin{algorithmic}[1]
                \fontsize{11}{15}\selectfont\mathfont\slshape\BODY
            \end{algorithmic}
        \end{algorithm}
    \end{fullwidth}
    \vspace{-9mm}
    \begin{flushright}\rule{15.77cm}{0.7pt}\end{flushright}
    \vspace{-2mm}
}

\NewEnviron{mypar}
{
    \setlength{\leftskip}{\parindent}
    \BODY\par
    \setlength{\leftskip}{0pt}
}

\NewEnviron{mymath}[1][normal]
{
    \setlength{\mathindent}{3mm}
    \setlength{\jot}{2mm}
    \vspace{+7mm}
    \ifthenelse{\equal{#1}{lower}}
        {\newmdenv[topline=false]{myframe}}
        {\newmdenv[topline=true,bottomline=true]{myframe}}
    \begin{myframe}[userdefinedwidth=16.6cm,linewidth=0.45pt,leftmargin=8.2mm,innerleftmargin=1mm,innertopmargin=1mm,innerbottommargin=1mm]
    {
        \begin{minipage}[c]{15.55cm}
            \vspace{-2mm}
            {\small
            \begin{align*}
                \BODY
            \end{align*}
            }%
            \vspace{-3mm}
        \end{minipage}
        \vspace{-1mm}
    }
    \end{myframe}
    \vspace{+3mm}
}

\NewEnviron{myitemize}
{
    \vspace{-4mm}
    \begin{itemize}[leftmargin=8mm,rightmargin=-0.5mm]
        \BODY
    \end{itemize}
    \vspace{-3mm}
}

\NewEnviron{myenumerate}
{
    \vspace{-4mm}
    \begin{enumerate}[leftmargin=8mm]
        \setlength{\itemsep}{-0.5mm}
        \BODY
    \end{enumerate}
    \vspace{-3mm}
}

% For tabular environment
\newcolumntype{L}[1]{>{\raggedright\arraybackslash}m{#1}}
\newcolumntype{C}[1]{>{\centering\arraybackslash}m{#1}}
\newcolumntype{R}[1]{>{\raggedleft\arraybackslash}m{#1}}
\aboverulesep=0ex
\belowrulesep=0ex
\renewcommand{\arraystretch}{1.3}
\setlength{\LTleft}{8mm}

\title{[Course no.]: [Assignment Name] Solution}
\author{Harish Rajagopal - 160552}

\begin{document}
    \setlength{\voffset}{-2mm}
    \setlength{\footskip}{35pt}

    \begin{center}
        \fontfamily{cmr}\selectfont
        {\huge Solution}\\[+2mm]
        {\Large [Course no.]: [Course name]\\[+2mm]
                [Assignment name]}\\[+3mm]
        {\large Harish Rajagopal\\[+1mm]
                160552}\\[+2mm]
        \rule{45mm}{0.5pt}\\[+9mm]
    \end{center}

    \setlength{\parindent}{8mm}
    \setlength{\parskip}{2mm}

    \noindent\textbf{\fontsize{14}{17}\selectfont [Problem No.]:}\par
        \underline{[Heading]}\par
        \vspace{+1mm}
            \textit{[Sub-Heading]}\par
            \begin{mypar}
                [Sample Text.]
            \end{mypar}
            \vspace{+1mm}

            \begin{mycode}
            {
                \item sample;
                \item code;
            }
            \end{mycode}
            \vspace{-6mm}

            \begin{mymath}
                &sample =\\
                &math =
            \end{mymath}
            \vspace{-3mm}

            \begin{mypseudocode}{Sample-Function}{args}
                \State sample
                \State pseudocode
            \end{mypseudocode}

            \begin{myitemize}
                \item Sample\\[-8mm]
                \item Bullets
            \end{myitemize}

            \begin{myenumerate}
                \item Sample
                \item List
            \end{myenumerate}
            \vspace{-3mm}

            {\centering
            \textit{Sample Table}\par}
            \vspace{-1mm}
            \begin{longtable}{ | C{35mm} | C{35mm} |  C{35mm} | C{35.5mm} | }
                \toprule
                One & Two & Three & Four\\
                \midrule\midrule
                1 & 2 & 3 & 4\\
                \midrule
                5 & 6 & 7 & 8\\
                \bottomrule
            \end{longtable}

            \begin{center}\rule{45mm}{0.5pt}\end{center}

\end{document}
